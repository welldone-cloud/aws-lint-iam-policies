{
    "_metadata": {
        "invocation": "aws_lint_iam_policies.py --scope ORGANIZATION --member-accounts-role OrganizationAccountAccessRole --include-ous ou-sbja-c5fcd2b2",
        "account_id": "822471601234",
        "principal": "arn:aws:sts::822471601234:assumed-role/AdminRole/admin",
        "scope": "ORGANIZATION",
        "run_timestamp": "20241226200517",
        "number_of_policies_analyzed": 38,
        "number_of_results_collected": 10,
        "errors": [
            "Error for account ID 737767487588, region ap-southeast-5, policy type iam_identity_center_application_policies: AccessDeniedException ()",
            "Error for account ID 737767487588, region ap-southeast-5, policy type iam_identity_center_permission_set_inline_policies: AccessDeniedException ()"
        ]
    },
    "results": [
        {
            "account_id": "737767487588",
            "region": "eu-central-1",
            "source_service": "s3",
            "resource_type": "AWS::S3::Bucket",
            "resource_name": "applicationbucket-737767487588",
            "resource_arn": "arn:aws:s3:::applicationbucket-737767487588",
            "finding_type": "SECURITY_WARNING",
            "finding_issue_code": "PUBLIC_ACCESS",
            "finding_description": "The resource policy grants public access for the given resource type.",
            "finding_link": "https://docs.aws.amazon.com/access-analyzer/latest/APIReference/API_CheckNoPublicAccess.html",
            "policy_type": "s3_bucket_policies",
            "policy_file_name": "737767487588_eu-central-1_s3_AWS_S3_Bucket_applicationbucket-737767487588_0.json"
        },
        {
            "account_id": "737767487588",
            "region": "eu-central-1",
            "source_service": "s3",
            "resource_type": "AWS::S3::Bucket",
            "resource_name": "share-737767487588",
            "resource_arn": "arn:aws:s3:::share-737767487588",
            "finding_type": "ERROR",
            "finding_issue_code": "MISSING_TAG_KEY_IN_CONDITION",
            "finding_description": "The condition key aws:PrincipalTag must include a tag-key to control access based on tags. Use the format aws:PrincipalTag/tag-key and specify a key name for tag-key.",
            "finding_link": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html#access-analyzer-reference-policy-checks-error-missing-tag-key-in-condition",
            "policy_type": "s3_bucket_policies",
            "policy_file_name": "737767487588_eu-central-1_s3_AWS_S3_Bucket_share-737767487588_0.json"
        },
        {
            "account_id": "737767487588",
            "region": "us-east-1",
            "source_service": "iam",
            "resource_type": "AWS::IAM::AssumeRolePolicyDocument",
            "resource_name": "TemporaryAdminRole",
            "resource_arn": "arn:aws:iam::737767487588:role/TemporaryAdminRole",
            "finding_type": "SUGGESTION",
            "finding_issue_code": "EMPTY_OBJECT_CONDITION",
            "finding_description": "This condition block is empty and it does not affect the policy. Specify conditions.",
            "finding_link": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html#access-analyzer-reference-policy-checks-suggestion-empty-object-condition",
            "policy_type": "iam_role_trust_policies",
            "policy_file_name": "737767487588_us-east-1_iam_AWS_IAM_AssumeRolePolicyDocument_TemporaryAdminRole_0.json"
        },
        {
            "account_id": "737767487588",
            "region": "us-east-1",
            "source_service": "iam",
            "resource_type": "AWS::IAM::AssumeRolePolicyDocument",
            "resource_name": "TemporaryAdminRole",
            "resource_arn": "arn:aws:iam::737767487588:role/TemporaryAdminRole",
            "finding_type": "SECURITY_WARNING",
            "finding_issue_code": "TRUSTED_OUTSIDE_PRINCIPAL",
            "finding_description": "The policy trusts principals outside the analyzed AWS account. A review is recommended to determine whether this is the desired setup. Trusted principals: ['arn:aws:iam::251094496418:root']",
            "finding_link": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies-cross-account-resource-access.html",
            "policy_type": "iam_role_trust_policies",
            "policy_file_name": " 737767487588_us-east-1_iam_AWS_IAM_AssumeRolePolicyDocument_TemporaryAdminRole_0.json"
        },
        {
            "account_id": "737767487588",
            "region": "us-east-1",
            "source_service": "iam",
            "resource_type": "AWS::IAM::AssumeRolePolicyDocument",
            "resource_name": "rds-monitoring-role",
            "resource_arn": "arn:aws:iam::737767487588:role/rds-monitoring-role",
            "finding_type": "SUGGESTION",
            "finding_issue_code": "EMPTY_SID_VALUE",
            "finding_description": "Add a value to the empty string in the Sid element.",
            "finding_link": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html#access-analyzer-reference-policy-checks-suggestion-empty-sid-value",
            "policy_type": "iam_role_trust_policies",
            "policy_file_name": "737767487588_us-east-1_iam_AWS_IAM_AssumeRolePolicyDocument_rds-monitoring-role_0.json"
        },
        {
            "account_id": "737767487588",
            "region": "us-east-1",
            "source_service": "iam",
            "resource_type": "AWS::IAM::Role",
            "resource_name": "TemporaryAdminRole:allow_lambda_access",
            "resource_arn": "arn:aws:iam::737767487588:role/TemporaryAdminRole",
            "finding_type": "SECURITY_WARNING",
            "finding_issue_code": "PASS_ROLE_WITH_STAR_IN_RESOURCE",
            "finding_description": "Using the iam:PassRole action with wildcards (*) in the resource can be overly permissive because it allows iam:PassRole permissions on multiple resources. We recommend that you specify resource ARNs or add the iam:PassedToService condition key to your statement.",
            "finding_link": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html#access-analyzer-reference-policy-checks-security-warning-pass-role-with-star-in-resource",
            "policy_type": "iam_role_trust_policies",
            "policy_file_name": "737767487588_us-east-1_iam_AWS_IAM_Role_TemporaryAdminRole_allow_lambda_access_0.json"
        },
        {
            "account_id": "251094496418",
            "region": "ap-southeast-1",
            "source_service": "sns",
            "resource_type": "AWS::SNS::Topic",
            "resource_name": "swarmhost-notification",
            "resource_arn": "arn:aws:sns:ap-southeast-1:251094496418:swarmhost-notification",
            "finding_type": "SUGGESTION",
            "finding_issue_code": "REDUNDANT_ACTION",
            "finding_description": "The 2 action(s) are redundant because they provide similar permissions. Update the policy to remove the redundant action such as: SNS:Subscribe.",
            "finding_link": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html#access-analyzer-reference-policy-checks-suggestion-redundant-action",
            "policy_type": "sns_topic_policies",
            "policy_file_name": "251094496418_ap-southeast-1_sns_AWS_SNS_Topic_swarmhost-notification_0.json"
        },
        {
            "account_id": "251094496418",
            "region": "ap-southeast-1",
            "source_service": "sns",
            "resource_type": "AWS::SNS::Topic",
            "resource_name": "swarmhost-notification",
            "resource_arn": "arn:aws:sns:ap-southeast-1:251094496418:swarmhost-notification",
            "finding_type": "SECURITY_WARNING",
            "finding_issue_code": "TRUSTED_OUTSIDE_PRINCIPAL",
            "finding_description": "The policy trusts principals outside the analyzed AWS account. A review is recommended to determine whether this is the desired setup. Trusted principals: ['arn:aws:iam::737767487588:root']",
            "finding_link": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies-cross-account-resource-access.html",
            "policy_type": "sns_topic_policies",
            "policy_file_name": "251094496418_ap-southeast-1_sns_AWS_SNS_Topic_swarmhost-notification_0.json"
        },
        {
            "account_id": "251094496418",
            "region": "us-east-1",
            "source_service": "iam",
            "resource_type": "AWS::IAM::AssumeRolePolicyDocument",
            "resource_name": "EC2RoleForSSM",
            "resource_arn": "arn:aws:iam::251094496418:role/EC2RoleForSSM",
            "finding_type": "SUGGESTION",
            "finding_issue_code": "EMPTY_SID_VALUE",
            "finding_description": "Add a value to the empty string in the Sid element.",
            "finding_link": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html#access-analyzer-reference-policy-checks-suggestion-empty-sid-value",
            "policy_type": "iam_role_trust_policies",
            "policy_file_name": "251094496418_us-east-1_iam_AWS_IAM_AssumeRolePolicyDocument_EC2RoleForSSM_0.json"
        },
        {
            "account_id": "251094496418",
            "region": "us-east-1",
            "source_service": "iam",
            "resource_type": "AWS::IAM::AssumeRolePolicyDocument",
            "resource_name": "SwimBikeRunRole",
            "resource_arn": "arn:aws:iam::251094496418:role/SwimBikeRunRole",
            "finding_type": "SUGGESTION",
            "finding_issue_code": "EMPTY_OBJECT_CONDITION",
            "finding_description": "This condition block is empty and it does not affect the policy. Specify conditions.",
            "finding_link": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html#access-analyzer-reference-policy-checks-suggestion-empty-object-condition",
            "policy_type": "iam_role_trust_policies",
            "policy_file_name": "251094496418_us-east-1_iam_AWS_IAM_AssumeRolePolicyDocument_SwimBikeRunRole_0.json"
        }
    ]
}